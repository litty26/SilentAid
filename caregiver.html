<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SilentAid — Caregiver</title>
  <link rel="stylesheet" href="caregiver.css" />
  <link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#1f77ff">
</head>
<body>
  <div class="cg-shell">
    <!-- Left rail -->
    <aside class="cg-rail cg-rail-left" aria-label="Navigation & account">
      <div class="cg-rail-group">
        <h2 class="cg-rail-title">Caregiver</h2>
        <div id="profileSection" class="cg-profile"></div>
      </div>

      <div class="cg-rail-group">
        <h3 class="cg-rail-sub">Connect user</h3>
        <div class="cg-stack">
          <input id="linkUserInput" class="cg-input" placeholder="Link by username" />
          <button id="linkUserBtn" class="cg-btn primary">Link</button>
          <div class="cg-or">or</div>
          <div class="cg-row">
            <input id="linkCodeInput" class="cg-input" placeholder="Enter 6‑digit code" />
            <button id="useCodeBtn" class="cg-btn">Use code</button>
          </div>
          <button id="showQRBtn" class="cg-btn ghost">Show my QR</button>
          <div id="careQR" class="cg-qr sr-only" aria-hidden="true"></div>
          <p class="cg-hint">Ask the user to scan or enter the code to pair quickly.</p>
        </div>
      </div>

      <div class="cg-rail-group">
        <h3 class="cg-rail-sub">Linked user</h3>
        <div id="connectedInfo"></div>
        <div class="cg-presence" id="presenceInfo"></div>
        <div class="cg-row">
          <label class="cg-switch">
            <input type="checkbox" id="dndToggle" />
            <span>Do not disturb</span>
          </label>
        </div>
      </div>

      <div class="cg-rail-group">
        <h3 class="cg-rail-sub">Export / Import</h3>
        <button id="exportBtn" class="cg-btn ghost">📤 Export user data</button>
        <label class="cg-file">
          <input type="file" id="importFile" />
          <span>📥 Import user data</span>
        </label>
      </div>

      <div class="cg-rail-group">
        <button id="logoutBtn" class="cg-btn danger">Logout</button>
      </div>
    </aside>

    <!-- Main -->
    <main class="cg-main">
      <header class="cg-header">
        <h1 class="cg-title">SilentAid — Caregiver</h1>
        <div class="cg-header-ctrls">
          <select id="langSelect" class="cg-select">
            <option value="en-US">English</option>
            <option value="hi-IN">हिन्दी</option>
            <option value="ml-IN">മലയാളം</option>
          </select>
          <button id="themeToggle" class="cg-icon-btn" title="Toggle theme">🌓</button>
        </div>
      </header>
      <br>
      <!-- Overview strip -->
      <section class="cg-card cg-overview">
        <div class="cg-avatar" aria-hidden="true">👤</div>
        <div class="cg-overview-main">
          <div class="cg-over-title" id="ovUser">No user linked</div>
          <div class="cg-over-sub"><span id="ovStatus">—</span> • Last seen <span id="ovSeen">—</span></div>
        </div>
        <div class="cg-over-actions">
          <button id="ovSpeakBtn" class="cg-btn">🔊 Speak now</button>
          <button id="ovPingBtn" class="cg-btn ghost">🛎️ Ping</button>
          <button id="ovWaterBtn" class="cg-btn success">💧 Water</button>
          <button id="ovMedsBtn" class="cg-btn success">💊 Meds</button>
        </div>
      </section>

      <!-- Tabs -->
      <div class="cg-tabs" id="cgTabs" role="tablist">
        <button class="cg-tab active" data-tab="manage" role="tab" aria-selected="true">Manage</button>
        <button class="cg-tab" data-tab="packs" role="tab">Packs</button>
        <button class="cg-tab" data-tab="remote" role="tab">Remote & reminders</button>
      </div>

      <!-- Two-column content area -->
      <section class="cg-grid-main">
        <!-- Left column -->
        <div class="cg-col">
          <div class="cg-card" data-panel="manage">
            <div class="cg-card-head">
              <h3>Quick phrases</h3>
              <div class="cg-row">
                <input id="phraseSearch" class="cg-input" placeholder="Search phrases..." />
                <select id="phraseFilter" class="cg-select">
                  <option value="">All</option>
                  <option value="short">Short</option>
                  <option value="long">Long</option>
                </select>
              </div>
            </div>
            <div id="userQuickPhrases" class="cg-chip-grid"></div>
            <div class="cg-row">
              <input id="newQuick" class="cg-input" placeholder="Add quick phrase for user..." />
              <button id="addQuickBtn" class="cg-btn">➕ Add</button>
              <button id="bulkClearQuick" class="cg-btn danger">Clear all</button>
            </div>

            <div class="cg-divider"></div>
            <div class="cg-card-head"><h3>Saved phrases</h3></div>
            <div id="userSavedPhrases" class="cg-stack-sm"></div>
          </div>

          <div class="cg-card sr-only" data-panel="packs" aria-hidden="true">
            <div class="cg-card-head"><h3>Phrase packs</h3></div>
            <div id="packList" class="cg-grid-2"></div>
            <div class="cg-row">
              <input id="packName" class="cg-input" placeholder="New pack name" />
              <button id="createPackBtn" class="cg-btn success">Create pack</button>
            </div>
            <div class="cg-hint">Click a pack to edit, then push to user.</div>
          </div>
        </div>

        <!-- Right column -->
        <div class="cg-col">
          <div class="cg-card sr-only" data-panel="remote" aria-hidden="true">
            <div class="cg-card-head"><h3>Remote & reminders</h3></div>
            <div class="cg-stack">
              <div class="cg-row">
                <input id="remoteSayInput" class="cg-input" placeholder="Text to speak on user device" />
                <button id="remoteSayBtn" class="cg-btn primary">🔊 Speak on user</button>
              </div>
              <div class="cg-row">
                <input id="remoteReminderInput" class="cg-input" placeholder="Reminder text" />
                <button id="sendReminderBtn" class="cg-btn">Set reminder</button>
              </div>
              <div class="cg-row">
                <button id="checkInBtn" class="cg-btn ghost">🛎️ Send check‑in prompt</button>
                <span id="checkInStatus" class="cg-hint"></span>
              </div>
              <div class="cg-divider"></div>
              <div class="cg-card-head"><h3>Mailbox</h3></div>
              <div class="cg-mailbox">
                <div class="cg-row">
                  <button id="clearMailbox" class="cg-btn ghost">Clear mailbox</button>
                </div>
                <div id="mailboxList" class="cg-stack-sm"></div>
              </div>
            </div>
          </div>

          <!-- Activity & metrics always visible -->
          <div class="cg-card">
            <div class="cg-card-head"><h3>Recent activity</h3></div>
            <div id="alertsList" class="cg-stack-sm"></div>
            <div class="cg-divider"></div>
            <div class="cg-card-head"><h3>Usage</h3></div>
            <div id="usageList" class="cg-stack-sm"></div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Pack editor -->
  <dialog id="packModal" class="cg-modal">
    <div class="cg-card">
      <div class="cg-card-head"><h3 id="packTitle">Edit pack</h3></div>
      <div id="packPhrases" class="cg-stack-sm"></div>
      <div class="cg-row">
        <input id="packPhraseInput" class="cg-input" placeholder="Add phrase…" />
        <button id="addPackPhraseBtn" class="cg-btn">Add</button>
      </div>
      <div class="cg-row">
        <button id="pushPackBtn" class="cg-btn primary">Push to user</button>
        <button id="deletePackBtn" class="cg-btn danger">Delete pack</button>
        <button id="closePackBtn" class="cg-btn ghost">Close</button>
      </div>
    </div>
  </dialog>

  <script src="caregiver.js"></script>
  <script>
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("./sw.js")
      .then(() => console.log("✅ Service Worker registered"))
      .catch(err => console.error("⚠️ Service Worker failed", err));
  }
</script>

</body>
</html>
